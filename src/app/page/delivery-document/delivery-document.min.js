function calldelDocPDF(a){$("#delDocPDFForm #delDocId").val(a),$("#delDocPDFForm").submit()}function calldelDocPDFLink(a){$("#delDocPDFForm #delDocId").val(a),$("#delDocPDFForm #delDocPrint").val("false"),$("#delDocPDFForm").submit()}function goToOrderDetails(a){$("#orderDetailsForm #orderId").val(a),$("#orderDetailsForm #hybrisOrder").val(!1),$("#orderDetailsForm").submit()}function goToEftDetails(a,b){$("#eftForm #eftId").val(a),$("#eftForm #fiscalYear").val(b),$("#eftForm").submit()}function paydelDoc(){if(!disablePayError||enabledelDocError||enableTotalError){$(".alert-danger").addClass("hide"),disablePayError||$(".js-selected-product-error").removeClass("hide"),enabledelDocError&&$(".js-selected-delDoc-error").removeClass("hide"),enableTotalError&&$(".js-total-amount-error").removeClass("hide");var a=[];$("#table tbody").find("tr.selected input[name='type']").each(function(){a=$(this).val().split("@"),(productCodes.indexOf(a[0])==-1||delDocStatusCodes.indexOf(a[1])>-1)&&$(this).parents("tr").addClass("bg-danger")})}else $.isEmptyObject(delDocObj)&&(delDocObj.account=$("#accountSelectDdn").val(),delDocObj.soldTo=$("#locationSelectDdn").val(),delDocObj.delDocNumber=$("#delDocNumber").val(),delDocObj.salesOrderNumber=$("#orderNumber").val(),delDocObj.poNumber=$("#poNumber").val(),delDocObj.delDocTypes=$("#delDocTypeDdn").val(),delDocObj.downloadStatus=$("#downloadStatus").val(),delDocObj.printStatus=$("#printStatus").val(),delDocObj.paymentStatus=$("#paymentStatusDdn").val(),delDocObj.startDate=startDate,delDocObj.endDate=endDate),localStorage.setItem("delDocObj",JSON.stringify(delDocObj)),$(".js-selected-product-error").addClass("hide"),$("#paymentForm #selecteddelDocs").val(selecteddelDocs.toString()),$("#paymentForm").submit()}function calldelDocPDF(a){$("#delDocPDFForm #delDocId").val(a),$("#delDocPDFForm").submit()}function calldelDocPDFLink(a){$("#delDocPDFForm #delDocId").val(a),$("#delDocPDFForm #delDocPrint").val("false"),$("#delDocPDFForm").submit()}function goToOrderDetails(a){$("#orderDetailsForm #orderId").val(a),$("#orderDetailsForm #hybrisOrder").val(!1),$("#orderDetailsForm").submit()}function goToEftDetails(a,b){$("#eftForm #eftId").val(a),$("#eftForm #fiscalYear").val(b),$("#eftForm").submit()}function paydelDoc(){if(!disablePayError||enabledelDocError||enableTotalError){$(".alert-danger").addClass("hide"),disablePayError||$(".js-selected-product-error").removeClass("hide"),enabledelDocError&&$(".js-selected-delDoc-error").removeClass("hide"),enableTotalError&&$(".js-total-amount-error").removeClass("hide");var a=[];$("#table tbody").find("tr.selected input[name='type']").each(function(){a=$(this).val().split("@"),(-1==productCodes.indexOf(a[0])||delDocStatusCodes.indexOf(a[1])>-1)&&$(this).parents("tr").addClass("bg-danger")})}else $.isEmptyObject(delDocObj)&&(delDocObj.account=$("#accountSelectDdn").val(),delDocObj.soldTo=$("#locationSelectDdn").val(),delDocObj.delDocNumber=$("#delDocNumber").val(),delDocObj.salesOrderNumber=$("#orderNumber").val(),delDocObj.poNumber=$("#poNumber").val(),delDocObj.delDocTypes=$("#delDocTypeDdn").val(),delDocObj.downloadStatus=$("#downloadStatus").val(),delDocObj.printStatus=$("#printStatus").val(),delDocObj.paymentStatus=$("#paymentStatusDdn").val(),delDocObj.startDate=startDate,delDocObj.endDate=endDate),localStorage.setItem("delDocObj",JSON.stringify(delDocObj)),$(".js-selected-product-error").addClass("hide"),$("#paymentForm #selecteddelDocs").val(selecteddelDocs.toString()),$("#paymentForm").submit()}var locationDropDownOptions=[],startDate,endDate,pastSelectableDate=6,delDocObj={},delDocTotalSum=0;if(locationDropDownOptions=locationDropDown.map(function(a,b){return{key:a.soldToNumber,value:a.soldToAddress}}),locationDropDownOptions.length>1&&locationDropDownOptions.unshift({key:"all",value:"All"}),cbp.delDocsPage.locationDropDown.options=locationDropDownOptions,cbp.delDocsPage.locationDropDown.searchable=!0,paymentStatusDropdownOptions.length>1){var obj={};obj.key="all",obj.value=cbp.delDocsPage.paymentStatusDropdown.title,paymentStatusDropdownOptions.unshift(obj)}cbp.delDocsPage.paymentStatusDropdown.options=paymentStatusDropdownOptions;var selecteddelDocs=[],selectedProduct=[],selecteddelDocStatus=[],disablePayError=!1,enabledelDocError=!1,enableTotalError=!1;require(["modernizr","jquery","bootstrap","handlebars","moment","calendar","bootstrap-select","bootstrap-table","text!app/components/calendar/_calendar.hbs","text!app/components/dropdown/_defaultDdn.hbs","text!app/page/delDocs/searchForm.hbs","text!app/page/delDocs/delDocsSummary.hbs","text!app/page/delDocs/bottomDetail.hbs"],function(a,b,c,d,e,f,g,h,j,k,l,m,n){var o=d.compile(k),p=d.compile(j),q=d.compile(l),r=d.compile(m),s=d.compile(n),t=function(){function a(){var a=delDocsResponse.summaryResponse;if(a.length>5){a=a.split(",");var b=a[0],c=a.splice(1);delDocsResponse.soldaccountBlock=b+",",delDocsResponse.soldaccountNormal=c}else delDocsResponse.soldaccountBlock=a,delDocsResponse.soldaccountNormal=""}var c={locationDdnContainer:".js-location-ddn",accountDdnContainer:".js-account-ddn",delDocsSummaryContainer:".js-delDocs-summary",delDocsTypeContainer:".js-delDocsType-ddn",paymentStatusContainer:".js-paymentStatus-ddn",downloadStatusContainer:".js-downloadStatus-ddn",printStatusContainer:".js-printStatus-ddn",pickDateRangeContainer:".js-search-pickDateRange",searchFormContainer:".js-search-form",searchDetailContainer:".js-bottom-detail",sortByDdnContainer:".js-sortbyDdn",dropDownCommon:".selectpicker",ordercalendar:"#calendar",searchButton:"#delDocsSearch",tabelRow:"#table tbody tr",downloadBtn:".js-downloadBtn",printBtn:".js-printBtn",payInvBtn:".js-payInvBtn",delDocTypeDdn:"#delDocTypeDdn",paymentStatusDdn:"#paymentStatusDdn",locationDdn:"#locationSelectDdn",accountDdn:"#accountSelectDdn",downloadStatusDdn:"#downloadStatus",printStatusDdn:"#printStatus",sortByDdn:"#sortByDdn",displaySpinner:".overlay-wrapper",dropdownSelect:".dropdown-menu .toggle-select",delDocNumber:"#delDocNumber",orderNumber:"#orderNumber",poNumber:"#poNumber",squareUnchecked:"fa-square-o",squareChecked:"fa-check-square-o",downloadIcon:".iconsPrintDownload",printIcon:".iconsdelDocPrint"},d=function(){if(h(),1==cbp.delDocsPage.locationDropDown.options.length?(A(b(c.locationDdn).val(),"all"),b(c.searchButton).removeAttr("disabled")):cbp.delDocsPage.locationDropDown.options.length>1,b(c.locationDdn).selectpicker("refresh"),z(accountListOnLoad),"true"===alldelDocFlow&&(b(c.downloadStatusDdn).val("notDownloaded").selectpicker("refresh"),b(c.printStatusDdn).val("notPrinted").selectpicker("refresh")),void 0!==localStorage.getItem("delDocObj")&&null!==localStorage.getItem("delDocObj")&&isPaymentFlow){var a=JSON.parse(localStorage.getItem("delDocObj"));startDate=a.startDate,endDate=a.endDate,cbp.delDocsPage.dateRange.startDate=e(startDate,cbp.delDocsPage.dateRange.format,!0),cbp.delDocsPage.dateRange.endDate=e(endDate,cbp.delDocsPage.dateRange.format,!0),b(c.delDocNumber).val(a.delDocNumber),b(c.orderNumber).val(a.salesOrderNumber),b(c.poNumber).val(a.poNumber),b(c.delDocTypeDdn).val(a.delDocTypes).selectpicker("refresh"),b(c.paymentStatusDdn).val(a.paymentStatus).selectpicker("refresh"),b(c.downloadStatusDdn).val(a.downloadStatus).selectpicker("refresh"),b(c.printStatusDdn).val(a.printStatus).selectpicker("refresh"),b(c.locationDdn).val(a.soldTo).selectpicker("refresh"),b.when(A(a.soldTo,a.account)).then(function(a){m()}),localStorage.removeItem("delDocObj"),b(c.searchButton).removeAttr("disabled")}else D(cbp.delDocsPage.delDocsResponse.delDocsDataList,cbp.delDocsPage.delDocsResponse.delDocsSearchList);l(),B(),"true"===noCardsAdded&&"true"===ccPaymentEligible?b(".js-card-error").removeClass("hide"):"true"===allCardsExpired&&"true"===ccPaymentEligible&&b(".js-card-expired-error").removeClass("hide")},f=function(){b("#delDocForm #selecteddelDocs").val(selecteddelDocs.toString());for(var a=0;len=selecteddelDocs.length,a<len;a++)b(".iconsPrintDownload[data-delDocid='"+selecteddelDocs[a]+"']").addClass("success-icon"),cbp.delDocsPage.delDocsResponse.delDocsDataList[b("tr[data-uniqueid='"+selecteddelDocs[a]+"']").data("index")].downloaded=!0;b("#delDocForm").submit(),selecteddelDocs.length=0},g=function(){var a=selecteddelDocs.length;b("#delDocForm #selecteddelDocs").val(selecteddelDocs.toString());var c=b("#contextPath").val()+"/delDocs/delDocListPDF",d=b("#delDocForm").attr("action");b("#delDocForm").attr("action",c),b("#delDocForm").attr("target","_blank");for(var e=0;e<a;e++)b(".iconsdelDocPrint[data-delDocid='"+selecteddelDocs[e]+"']").addClass("success-icon"),cbp.delDocsPage.delDocsResponse.delDocsDataList[b("tr[data-uniqueid='"+selecteddelDocs[e]+"']").data("index")].printed=!0;b("#delDocForm").submit(),b("#delDocForm").attr("action",d),b("#delDocForm").removeAttr("target"),selecteddelDocs.length=0},h=function(){b(c.searchFormContainer).html(q(cbp.delDocsPage)),b(c.locationDdnContainer).html(o(cbp.delDocsPage.locationDropDown)),b(c.accountDdnContainer).html(o(cbp.delDocsPage.accountDropDown)),b(c.downloadStatusContainer).html(o(cbp.delDocsPage.downloadStatusDropdown)),b(c.delDocsTypeContainer).html(o(cbp.delDocsPage.delDocTypeDropdown)),b(c.paymentStatusContainer).html(o(cbp.delDocsPage.paymentStatusDropdown)),b(c.printStatusContainer).html(o(cbp.delDocsPage.printStatusDropdown)),b(c.pickDateRangeContainer).html(p({label:cbp.delDocsPage.globalVars.pickDateRange,iconClass:cbp.delDocsPage.dateRange.iconClass,id:cbp.delDocsPage.dateRange.id})),console.log("option select all in ship to",accountListOnLoad.length),accountListOnLoad.length<2?(cbp.delDocsPage.showSoldTo=!1,delDocsResponse.summaryResponse=delDocsResponse.summary.account):(cbp.delDocsPage.showSoldTo=!0,delDocsResponse.summaryResponse=delDocsResponse.summary.soldTo),j(),b(c.dropDownCommon).selectpicker("refresh"),k(),b(c.displaySpinner).hide()},j=function(){a(),b(c.delDocsSummaryContainer).html(r(cbp.delDocsPage)),b(c.searchDetailContainer).html(s(cbp.delDocsPage)),b(c.sortByDdnContainer).html(o(y)),b(c.sortByDdnContainer).find(c.dropDownCommon).selectpicker("refresh"),k()},k=function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)&&b(c.dropDownCommon).selectpicker("mobile")},l=function(){function a(a,d){startDate=a.format(cbp.delDocsPage.dateRange.format),endDate=d.format(cbp.delDocsPage.dateRange.format),b(c.ordercalendar).find("span").html(cbp.delDocsPage.globalVars.fromAndTo.replace("{0}",startDate).replace("{1}",endDate))}"true"===alldelDocFlow&&(cbp.delDocsPage.dateRange.startDate=e().subtract(cbp.delDocsPage.dateRange.maxMonth,"month")),a(cbp.delDocsPage.dateRange.startDate,cbp.delDocsPage.dateRange.endDate);var d={};d[cbp.delDocsPage.dateRange.today]=[e(),e()],d[cbp.delDocsPage.dateRange.yesterday]=[e().subtract(1,"days"),e().subtract(1,"days")],d[cbp.delDocsPage.dateRange.last7Days]=[e().subtract(6,"days"),e()],d[cbp.delDocsPage.dateRange.last30Days]=[e().subtract(29,"days"),e()],d[cbp.delDocsPage.dateRange.thisMonth]=[e().startOf("month"),e().endOf("month")],d[cbp.delDocsPage.dateRange.lastMonth]=[e().subtract(1,"month").startOf("month"),e().subtract(1,"month").endOf("month")],b(c.ordercalendar).daterangepicker({startDate:cbp.delDocsPage.dateRange.startDate,endDate:cbp.delDocsPage.dateRange.endDate,ranges:d,minDate:e().subtract(cbp.delDocsPage.dateRange.maxMonth,"month"),maxDate:e(),applyClass:"btn-primary",locale:{format:cbp.delDocsPage.dateRange.format,separator:" - ",applyLabel:cbp.delDocsPage.dateRange.apply,cancelLabel:cbp.delDocsPage.dateRange.cancel,weekLabel:"W",customRangeLabel:cbp.delDocsPage.dateRange.customRange,daysOfWeek:e.weekdaysShort(),monthNames:e.monthsShort(),firstDay:e.localeData().firstDayOfWeek()}},a)},m=function(){function a(a){b(c.displaySpinner).hide(),b(c.searchDetailContainer).show(),b(c.delDocsSummaryContainer).show(),cbp.delDocsPage.delDocsResponse=a,cbp.delDocsPage.delDocsResponse.resultCount>0?cbp.delDocsPage.globalVars.delDocsFoundVar=cbp.delDocsPage.globalVars.delDocsFound.replace("{0}",cbp.delDocsPage.delDocsResponse.resultCount):cbp.delDocsPage.globalVars.delDocsFoundVar=cbp.delDocsPage.globalVars.delDocsFound.replace("{0}",0),cbp.delDocsPage.dateRange.startDate=e(startDate,cbp.delDocsPage.dateRange.format,!0),cbp.delDocsPage.dateRange.endDate=e(endDate,cbp.delDocsPage.dateRange.format,!0),cbp.delDocsPage.globalVars.summaryfromAndToVar=cbp.delDocsPage.globalVars.summaryfromAndTo.replace("{0}",cbp.delDocsPage.dateRange.startDate.format(cbp.delDocsPage.dateRange.format)).replace("{1}",cbp.delDocsPage.dateRange.endDate.format(cbp.delDocsPage.dateRange.format)),"true"===alldelDocFlow||cbp.delDocsPage.delDocsResponse.resultCount>0&&cbp.delDocsPage.delDocsResponse.resultCount<maxResults?cbp.delDocsPage.showDebitCredit=!0:cbp.delDocsPage.showDebitCredit=!1,j(),D(cbp.delDocsPage.delDocsResponse.delDocsDataList,cbp.delDocsPage.delDocsResponse.delDocsSearchList),leftPaneExpandCollapse.resetSearchFormHeight()}function d(){b(c.displaySpinner).hide(),b(c.searchDetailContainer).show(),b(c.delDocsSummaryContainer).show(),console.log("error")}b(c.displaySpinner).show(),b(c.delDocsSummaryContainer).hide(),b(c.searchDetailContainer).hide(),leftPaneExpandCollapse.hideSearchBar();var f=[];b(c.delDocTypeDdn).find("option").each(function(){f.push(b(this).val())});var g={};if(g.account=b(c.accountDdn).val(),g.soldTo=b(c.locationDdn).val(),""!=b(c.delDocNumber).val()&&(g.delDocNumber=parseInt(b(c.delDocNumber).val().trim(),10),b(c.delDocNumber).val(g.delDocNumber)),""!=b(c.orderNumber).val()&&(g.salesOrderNumber=b(c.orderNumber).val().trim(),b(c.orderNumber).val(g.salesOrderNumber)),""!=b(c.poNumber).val()&&(g.poNumber=b(c.poNumber).val().trim(),b(c.poNumber).val(g.poNumber)),g.delDocTypes=[b(c.delDocTypeDdn).val()?""+b(c.delDocTypeDdn).val():f.toString()],g.downloadedStatus=b(c.downloadStatusDdn).val(),g.paymentStatus=b(c.paymentStatusDdn).find("option:selected").text(),g.printed=b(c.printStatusDdn).val(),""!=b(c.delDocNumber).val()||""!=b(c.orderNumber).val()||""!=b(c.poNumber).val()){var h=e().subtract(cbp.delDocsPage.dateRange.backDatedRange,"month");h=h.format(cbp.delDocsPage.dateRange.format);var i=e();i=i.format(cbp.delDocsPage.dateRange.format),g.fromDate=h,g.toDate=i}else g.fromDate=startDate,g.toDate=endDate;"all"!=b(c.accountDdn).val()?(cbp.delDocsPage.showSoldTo=!1,delDocsResponse.summaryResponse=delDocsResponse.summary.account):(cbp.delDocsPage.showSoldTo=!0,delDocsResponse.summaryResponse=delDocsResponse.summary.soldTo),b.ajax({type:"POST",data:JSON.stringify(g),contentType:"application/json",dataType:"json",url:cbp.delDocsPage.globalUrl.delDocPostURL,success:a,error:d})},n=function(){b(c.orderNumber).siblings("label").text(cbp.delDocsPage.globalVars.orderNumberNew),b(c.poNumber).siblings("label").text(cbp.delDocsPage.globalVars.poNumberNew),cbp.delDocsPage.globalVars.orderNumbertb=cbp.delDocsPage.globalVars.orderNumbertbNew,cbp.delDocsPage.globalVars.customerPOtb=cbp.delDocsPage.globalVars.customerPOtbNew},t=function(a){var c=window.location.pathname,d="<form id='downloadForm' method='POST' action='"+c+"/delDocCSV'><input type='hidden' name='selecteddelDocs' value='"+a+"'/></form>";cbp.delDocsPage.delDocsResponse.delDocsDataList[b("tr[data-uniqueid='"+a+"']").data("index")].downloaded=!0,b(d).appendTo("body").submit().remove()},u=function(){b(c.downloadBtn).removeClass("disabled"),b(c.printBtn).removeClass("disabled"),w()},v=function(){b(c.downloadBtn).addClass("disabled"),b(c.printBtn).addClass("disabled"),w()},w=function(){var a=selectedProduct.length;a>=0&&(disablePayError=!0);for(var d=0;d<a;d++)productCodes.indexOf(selectedProduct[d])==-1&&(disablePayError=!1);a>0?b(c.payInvBtn).removeClass("disabled"):b(c.payInvBtn).addClass("disabled"),(disablePayError||0===a)&&b(".js-selected-product-error").addClass("hide")},x=function(a){if(null!=a){globalSortList=[{key:"delDocDate-desc",value:cbp.delDocsPage.globalVars.delDocDateAsc},{key:"delDocDate-asc",value:cbp.delDocsPage.globalVars.delDocDateDesc},{key:"location-asc",value:cbp.delDocsPage.globalVars.locationSortAsc},{key:"location-desc",value:cbp.delDocsPage.globalVars.locationSortDesc},{key:"orderId-asc",value:cbp.delDocsPage.globalVars.orderNumberAsc},{key:"orderId-desc",value:cbp.delDocsPage.globalVars.orderNumberDesc},{key:"delDocId-asc",value:cbp.delDocsPage.globalVars.delDocNumberAsc},{key:"delDocId-desc",value:cbp.delDocsPage.globalVars.delDocNumberDesc},{key:"type-asc",value:cbp.delDocsPage.globalVars.delDocTypeAsc},{key:"type-desc",value:cbp.delDocsPage.globalVars.delDocTypeDesc},{key:"total-asc",value:cbp.delDocsPage.globalVars.totalAsc},{key:"total-desc",value:cbp.delDocsPage.globalVars.totalDesc}];var b=globalSortList.reduce(function(a,b){return a[b.key]=b,a},{});console.log(b);var c=Object.keys(b).filter(function(a){if(b[a])return b[a]});console.log(c);var d=Object.keys(a).filter(function(b){if(a[b])return a[b]});console.log(d);var e=function(a){return d.indexOf(a.replace(/\-(asc|desc)/,""))!=-1},f=c.filter(function(a){return e(a)});console.log("fgsdyfgkf",f);var g=[];for(i=0;i<f.length;i++){var h=f[i];console.log(h),g.push(b[h])}return console.log("req res",g),g}},y={options:x(delDocsResponse.delDocsSearchList),label:cbp.delDocsPage.globalVars.sortBy,labelClass:"xs-mr-5",name:"sortByDdn",display:"displayInline"},z=function(a){console.log("Calling in method >>>>>");var d=[];if(1==a.length)cbp.delDocsPage.accountDropDown.singleOption=!0,b(c.searchButton).removeAttr("disabled");else if(a.length>1){var e={};e.key="all",e.value=cbp.delDocsPage.globalVars.allTb,d.push(e)}for(var f=0;f<a.length;f++){var e={};e.key=a[f].uid,e.value=a[f].displayName,d.push(e)}cbp.delDocsPage.accountDropDown.options=d,cbp.delDocsPage.accountDropDown.searchable=!0,b(c.accountDdnContainer).html(o(cbp.delDocsPage.accountDropDown)),b(c.accountDdn).selectpicker("refresh")},A=function(a,d){function e(a){b(c.displaySpinner).hide();var e=[],f={},g=a;console.log(g),e=g.map(function(a,b){return{key:a.uid,value:a.displayName}}),1==g.length?cbp.delDocsPage.accountDropDown.singleOption=!0:g.length>=1&&(f.key="all",f.value=cbp.delDocsPage.globalVars.allTb,e.unshift(f)),console.log("accountOptions >>>",e),cbp.delDocsPage.accountDropDown.options=e,cbp.delDocsPage.accountDropDown.searchable=!0,b(c.accountDdnContainer).html(o(cbp.delDocsPage.accountDropDown)),b(c.accountDdn).selectpicker("refresh"),cbp.delDocsPage.accountDropDown.options.length>1&&b(c.accountDdn).val(d).selectpicker("refresh");var h=[];if(a.delDocTypeList)for(var i=0;i<a.delDocTypeList.length;i++){var j={};j.key=a.delDocTypeList[i].code,j.value=a.delDocTypeList[i].description,h.push(j)}cbp.delDocsPage.delDocTypeDropdown.options=h,b(c.delDocsTypeContainer).html(o(cbp.delDocsPage.delDocTypeDropdown)),b(c.delDocTypeDdn).selectpicker("refresh")}function f(){b(c.displaySpinner).hide(),console.log("error")}return b(c.displaySpinner).show(),b.ajax({type:"POST",data:{soldToNumber:a},dataType:"json",url:cbp.delDocsPage.globalUrl.accountURL,success:e,error:f})},B=function(){b(document).on("reset-view.bs.table, toggle.bs.table","#table",function(a){a.stopPropagation();for(var c=0;c<selecteddelDocs.length;c++)b("#table tbody tr[data-uniqueid="+selecteddelDocs[c]+"]").find("input[type=checkbox]").attr("checked","checked")}),b(document).on("click",c.downloadBtn,function(){f()}),b(document).on("click",c.printBtn,function(){g()}),b(c.locationDdn).on("change",function(a){""!==b(c.locationDdn).val()?b(c.searchButton).removeAttr("disabled"):b(c.searchButton).attr("disabled","disabled"),n(),A(b(c.locationDdn).val(),"all")}),b(document).on("change",c.accountDdn,function(a){""!==b(this).val()?b(c.searchButton).removeAttr("disabled"):b(c.searchButton).attr("disabled","disabled")}),b(document).on("click",c.downloadIcon,function(a){var c=b("#isInternalUser").val();"true"!=c&&"true"!==inASMSession&&b(a.target).addClass("success-icon"),t(b(a.target).attr("data-delDocId"))}),b(document).on("click",c.printIcon,function(a){var c=b("#isInternalUser").val();"true"!=c&&"true"!==inASMSession&&b(this).addClass("success-icon");var d=b(a.target).attr("data-delDocId");selecteddelDocs=[d],g()}),b(c.searchButton).on("click",function(a){selecteddelDocs=[],selectedProduct=[],selecteddelDocStatus=[],delDocObj.account=b("#accountSelectDdn").val(),delDocObj.soldTo=b("#locationSelectDdn").val(),delDocObj.delDocNumber=b("#delDocNumber").val(),delDocObj.salesOrderNumber=b("#orderNumber").val(),delDocObj.poNumber=b("#poNumber").val(),delDocObj.delDocTypes=b("#delDocTypeDdn").val(),delDocObj.downloadStatus=b("#downloadStatus").val(),delDocObj.printStatus=b("#printStatus").val(),delDocObj.paymentStatus=b("#paymentStatusDdn").val(),delDocObj.startDate=startDate,delDocObj.endDate=endDate,b(".alert-danger").addClass("hide"),m()});var a=".js-search-form input,"+c.printStatusContainer+","+c.locationDdnContainer+","+c.downloadStatusContainer+","+c.pickDateRangeContainer;b(document).on("keypress",a,function(a){13==a.which&&(a.preventDefault(),b("#delDocsSearch").trigger("click"))});var d=c.delDocNumber+","+c.orderNumber;b(document).on("keypress",d,function(a){var b=/^[0-9]+$/,c=String.fromCharCode(a.which);return!!c.match(b)||(a.preventDefault(),!1)})},C=function(a){if(null!=a){var b=Object.keys(a).filter(function(b){if(a[b])return a[b]});console.log("columns to be seen",b);var c=[{field:"checkbox",checkbox:!0,"class":"fa",formatter:function(a,b,c){return'<input type="hidden" name="type" value="'+b.type+"@"+b.cbpdelDocStatus+'">'}},{field:"status",title:cbp.delDocsPage.globalVars.statustb,titleTooltip:cbp.delDocsPage.globalVars.statustb,"class":"text-nowrap",formatter:function(a,b,c){var d,e,f="",g="";return b.downloaded&&"true"!==inASMSession&&(f="success-icon"),b.printed&&"true"!==inASMSession&&(g="success-icon"),d="<span class='fa fa-download iconsPrintDownload xs-pr-10 "+f+"' data-delDocId='"+b.delDocId+"'></span>",e="<span class='fa fa-print iconsdelDocPrint "+g+"' data-delDocId='"+b.delDocId+"'></span>",d+e}},{field:"location",title:cbp.delDocsPage.globalVars.locationtb,titleTooltip:cbp.delDocsPage.globalVars.locationtb,sortable:!0},{field:"delDocDate",title:cbp.delDocsPage.globalVars.pickDatetb,titleTooltip:cbp.delDocsPage.globalVars.pickDatetb,"class":"numberIcon text-nowrap",sorter:function(a,b){return a=e(a,cbp.delDocsPage.dateRange.format,!0).format(),b=e(b,cbp.delDocsPage.dateRange.format,!0).format(),a<b?-1:a>b?1:0},sortable:!0,align:"right"},{field:"purchaseOrderNumber",title:cbp.delDocsPage.globalVars.orderNumbertb+"<br> <i>"+cbp.delDocsPage.globalVars.customerPOtb+"</i>",titleTooltip:cbp.delDocsPage.globalVars.orderNumbertb,"class":"numberIcon text-nowrap",sortable:!0,formatter:function(a,b,c){var d,e;return d="ZOOR"==b.salesOrderType&&orderAvailable&&!cbp.delDocsPage.isNARegion?'<a href="javascript:void(0);" onclick="goToOrderDetails(\''+b.orderId+"')\">"+b.orderId+"</a>":b.orderId,e=void 0===b.purchaseOrderNumber||null===b.purchaseOrderNumber?"":"<br> <i>"+b.purchaseOrderNumber+"</i>",d+e}},{field:"delDocId",title:cbp.delDocsPage.globalVars.delDoctb+(showLegal?"<br> <i>"+cbp.delDocsPage.globalVars.legaldelDoctb+"</i>":""),titleTooltip:cbp.delDocsPage.globalVars.delDoctb,"class":"numberIcon text-nowrap",sortable:!0,formatter:function(a,b,c){var d,e;return d='<a href="javascript:void(0);" onclick="calldelDocPDFLink(\''+b.delDocId+"')\">"+b.delDocId+"</a>",e=void 0===b.legalDocumentNumber||null===b.legalDocumentNumber?"":showLegal?"<br> <i>"+b.legalDocumentNumber+"</i>":"",d+e}},{field:"type",title:cbp.delDocsPage.globalVars.docTypetb,titleTooltip:cbp.delDocsPage.globalVars.docTypetb,"class":cbp.delDocsPage.isNARegion?"":"text-nowrap",sortable:!0,formatter:function(a,b,c){return delDocTypeMapper[a]}},{field:"total",title:cbp.delDocsPage.globalVars.totaltb+(""===cbp.delDocsPage.delDocsResponse.currency?"":" ("+cbp.delDocsPage.delDocsResponse.currency+")")+("true"==ccPaymentEligible?"<br> <i>"+cbp.delDocsPage.globalVars.paymentStatustb+"</i>":""),titleTooltip:cbp.delDocsPage.globalVars.totaltb+" ("+cbp.delDocsPage.delDocsResponse.currency+")","class":"numberIcon text-nowrap",sortable:!0,align:"right",sorter:function(a,b){return null!==a&&null!==b&&(a=parseFloat(a),b=parseFloat(b)),a<b?-1:a>b?1:0},formatter:function(a,b,c){var d,e;return d=a>="0"?b.displayTotal:"<span class='text-danger'>"+b.displayTotal+"</span>",e=void 0===b.cbpdelDocStatus||null===b.cbpdelDocStatus||"false"==ccPaymentEligible||"00"===b.cbpdelDocStatus?"":"<br> <i><span class='text-danger'>"+delDocStatusMapper[b.cbpdelDocStatus]+"</span></i>",d+e}},{field:"eftNumber",title:cbp.delDocsPage.globalVars.eftNumber,titleTooltip:cbp.delDocsPage.globalVars.eftNumber,"class":"text-nowrap",sortable:!0,visible:cbp.delDocsPage.showEFT,formatter:function(a,b,c){return'<a href="javascript:void(0);" onclick="goToEftDetails(\''+a+"', '"+b.fiscalYear+"')\">"+a+"</a>"}},{field:"deliveryDate",title:cbp.delDocsPage.globalVars.deliveryDate,titleTooltip:cbp.delDocsPage.globalVars.deliveryDate,"class":"text-nowrap",visible:cbp.delDocsPage.showDeliveryDate,sortable:!0}],d=c.reduce(function(a,b){return a[b.field]=b,a},{});orderKey=["checkbox","status","location","delDocDate","delDocId","type","purchaseOrderNumber","total"],console.log("Required order",orderKey);for(var f=[],g=0;g<orderKey.length;g++)for(var h=0;h<b.length;h++)if(orderKey[g]==b[h]){var i=orderKey[g];f.push(d[i])}return f}},D=function(a,d){var e=0;cbp.delDocsPage.delDocsResponse.resultCount>maxResults&&null===cbp.delDocsPage.delDocsResponse.delDocsDataList?(cbp.delDocsPage.globalVars.tableLocales.noMatches=cbp.delDocsPage.globalVars.noMatchesMaxResults.replace("{0}",cbp.delDocsPage.delDocsResponse.resultCount),a=[]):0===cbp.delDocsPage.delDocsResponse.resultCount?cbp.delDocsPage.globalVars.tableLocales.noMatches=cbp.delDocsPage.globalVars.noMatches:cbp.delDocsPage.delDocsResponse.resultCount>maxResults&&"true"!=alldelDocFlow&&(cbp.delDocsPage.globalVars.tableLocales.noMatches=cbp.delDocsPage.globalVars.noMatchesMaxResults.replace("{0}",cbp.delDocsPage.delDocsResponse.resultCount),a=[]),null!==a&&void 0!==a||(a=[]),b(c.sortByDdn).val("delDocDate-desc").selectpicker("refresh"),b("#table").bootstrapTable({classes:"table table-no-bordered",striped:!0,sortName:"delDocDate",uniqueId:"delDocId",sortOrder:"desc",iconsPrefix:"fa",sortable:!0,parentContainer:".js-bottom-detail",sortByDropdownId:"#sortByDdn",responsive:!0,responsiveBreakPoint:768,responsiveClass:"bootstrap-table-cardview",onCheck:function(a,b){selecteddelDocs.push(a.delDocId),selectedProduct.push(a.type),selecteddelDocStatus.push(a.cbpdelDocStatus),delDocTotalSum+=a.total,delDocStatusCodes.indexOf(a.cbpdelDocStatus)>-1&&(e+=1),e>0&&(enabledelDocError=!0),enableTotalError=delDocTotalSum<=0,u()},onCheckAll:function(a){selecteddelDocs=[],selectedProduct=[],selecteddelDocStatus=[];for(var b=a.length,c=0;c<b;c++)selecteddelDocs.push(a[c].delDocId),selectedProduct.push(a[c].type),selecteddelDocStatus.push(a[c].cbpdelDocStatus),delDocTotalSum+=a[c].total,delDocStatusCodes.indexOf(a[c].cbpdelDocStatus)>-1&&(e+=1),e>0&&(enabledelDocError=!0);delDocTotalSum<=0&&(enableTotalError=!0),a.length&&u()},onUncheck:function(a,d){var f=selecteddelDocs.indexOf(a.delDocId);delDocTotalSum-=a.total,f>-1&&(selecteddelDocs.splice(f,1),selectedProduct.splice(f,1),selecteddelDocStatus.splice(f,1),w()),b(c.tabelRow).hasClass("selected")||v(),delDocStatusCodes.indexOf(a.cbpdelDocStatus)>-1&&(e-=1),e<=0&&(enabledelDocError=!1,b(".js-selected-delDoc-error").addClass("hide")),delDocTotalSum>=0?(enableTotalError=!1,b(".js-total-amount-error").addClass("hide")):enableTotalError=!0,d.parents("tr").removeClass("bg-danger")},onUncheckAll:function(a){selecteddelDocs=[],selectedProduct=[],selecteddelDocStatus=[],e=0,delDocTotalSum=0,enabledelDocError=!1,enableTotalError=!1,b(".js-selected-delDoc-error").addClass("hide"),b(".js-total-amount-error").addClass("hide"),v(),b("#table tbody").find("tr").removeClass("bg-danger")},columns:C(d),data:a})};return{init:d}}();b(document).ready(function(){b.fn.selectpicker.defaults={noneSelectedText:cbp.delDocsPage.globalVars.selectDdn.noneSelectedText,noneResultsText:cbp.delDocsPage.globalVars.selectDdn.noneResultsText,countSelectedText:function(a,b){return 1==a?cbp.delDocsPage.globalVars.selectDdn.itemSelected:cbp.delDocsPage.globalVars.selectDdn.itemSelected1},maxOptionsText:function(a,b){return[1==a?cbp.delDocsPage.globalVars.selectDdn.limitReached:cbp.delDocsPage.globalVars.selectDdn.limitReached1,1==b?cbp.delDocsPage.globalVars.selectDdn.groupLimit:cbp.delDocsPage.globalVars.selectDdn.groupLimit1]},selectAllText:cbp.delDocsPage.globalVars.selectDdn.selectAllText,deselectAllText:cbp.delDocsPage.globalVars.selectDdn.deselectAllText},b.fn.bootstrapTable.locales={formatLoadingMessage:function(){return cbp.delDocsPage.globalVars.tableLocales.loadingMessage},formatRecordsPerPage:function(a){return cbp.delDocsPage.globalVars.tableLocales.recordsPerPage.replace("{0}",a)},formatShowingRows:function(a,b,c){return cbp.delDocsPage.globalVars.tableLocales.showingRows.replace("{0}",a).replace("{1}",b).replace("{2}",c)},formatSearch:function(){return cbp.delDocsPage.globalVars.tableLocales.search},formatNoMatches:function(){return cbp.delDocsPage.globalVars.tableLocales.noMatches},formatPaginationSwitch:function(){return cbp.delDocsPage.globalVars.tableLocales.paginationSwitch},formatRefresh:function(){return cbp.delDocsPage.globalVars.tableLocales.refresh},formatToggle:function(){return cbp.delDocsPage.globalVars.tableLocales.toggle},formatColumns:function(){return cbp.delDocsPage.globalVars.tableLocales.columns},formatAllRows:function(){return cbp.delDocsPage.globalVars.tableLocales.allRows}},b.extend(b.fn.bootstrapTable.defaults,b.fn.bootstrapTable.locales),"false"==noCardsAdded&&"false"==allCardsExpired&&"true"==ccPaymentEligible&&"true"==showPaydelDoc?cbp.delDocsPage.showHidedelDocBtn="false":cbp.delDocsPage.showHidedelDocBtn="true",leftPaneExpandCollapse.init(),cbp.delDocsPage.showSoldTo=!0,cbp.delDocsPage.delDocsResponse=delDocsResponse,void 0===delDocsResponse.resultCount||null===delDocsResponse.resultCount?(cbp.delDocsPage.delDocsResponse.resultCount=0,cbp.delDocsPage.globalVars.delDocsFoundVar=cbp.delDocsPage.globalVars.delDocsFound.replace("{0}",0)):cbp.delDocsPage.globalVars.delDocsFoundVar=cbp.delDocsPage.globalVars.delDocsFound.replace("{0}",delDocsResponse.resultCount),void 0!==delDocsResponse.delDocsDataList&&null!==delDocsResponse.delDocsDataList||(cbp.delDocsPage.delDocsResponse.delDocsDataList=[]),"true"===alldelDocFlow||cbp.delDocsPage.delDocsResponse.resultCount>0&&cbp.delDocsPage.delDocsResponse.resultCount<maxResults?cbp.delDocsPage.showDebitCredit=!0:cbp.delDocsPage.showDebitCredit=!1,cbp.delDocsPage.dateRange.startDate=e().subtract(pastSelectableDate,"days"),cbp.delDocsPage.dateRange.endDate=e(),"true"===alldelDocFlow&&(cbp.delDocsPage.dateRange.startDate=e().subtract(cbp.delDocsPage.dateRange.maxMonth,"month")),cbp.delDocsPage.globalVars.summaryfromAndToVar=cbp.delDocsPage.globalVars.summaryfromAndTo.replace("{0}",cbp.delDocsPage.dateRange.startDate.format(cbp.delDocsPage.dateRange.format)).replace("{1}",cbp.delDocsPage.dateRange.endDate.format(cbp.delDocsPage.dateRange.format)),cbp.delDocsPage.ccPaymentEligible=ccPaymentEligible,cbp.delDocsPage.isNARegion=isNARegion,cbp.delDocsPage.isNARegion?(cbp.delDocsPage.showDeliveryDate=!0,cbp.delDocsPage.showEFT=!0):(cbp.delDocsPage.showDeliveryDate=!1,cbp.delDocsPage.showEFT=!1),t.init()})});for(var locationDropDownOptions=[],startDate,endDate,delDocObj={},delDocTotalSum=0,i=0;i<locationDropDown.length;i++){
var obj={};obj.key=locationDropDown[i].soldToNumber,obj.value=locationDropDown[i].soldToAddress,locationDropDownOptions.push(obj)}if(cbp.delDocsPage.locationDropDown.options=locationDropDownOptions,cbp.delDocsPage.locationDropDown.searchable=!0,paymentStatusDropdownOptions.length>1){var obj={};obj.key="all",obj.value=cbp.delDocsPage.paymentStatusDropdown.title,paymentStatusDropdownOptions.unshift(obj)}cbp.delDocsPage.paymentStatusDropdown.options=paymentStatusDropdownOptions;var selecteddelDocs=[],selectedProduct=[],selecteddelDocStatus=[],disablePayError=!1,enabledelDocError=!1,enableTotalError=!1;require(["modernizr","jquery","bootstrap","handlebars","moment","calendar","bootstrap-select","bootstrap-table","text!app/components/calendar/_calendar.hbs","text!app/components/dropdown/_defaultDdn.hbs","text!app/page/delDocs/searchForm.hbs","text!app/page/delDocs/delDocsSummary.hbs","text!app/page/delDocs/bottomDetail.hbs"],function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=d.compile(j),o=d.compile(i),p=d.compile(k),q=d.compile(l),r=d.compile(m),s=function(){var a={options:[{key:"delDocDate-desc",value:cbp.delDocsPage.globalVars.delDocDateAsc},{key:"delDocDate-asc",value:cbp.delDocsPage.globalVars.delDocDateDesc},{key:"location-asc",value:cbp.delDocsPage.globalVars.locationSortAsc},{key:"location-desc",value:cbp.delDocsPage.globalVars.locationSortDesc},{key:"orderId-asc",value:cbp.delDocsPage.globalVars.orderNumberAsc},{key:"orderId-desc",value:cbp.delDocsPage.globalVars.orderNumberDesc},{key:"delDocId-asc",value:cbp.delDocsPage.globalVars.delDocNumberAsc},{key:"delDocId-desc",value:cbp.delDocsPage.globalVars.delDocNumberDesc},{key:"type-asc",value:cbp.delDocsPage.globalVars.delDocTypeAsc},{key:"type-desc",value:cbp.delDocsPage.globalVars.delDocTypeDesc},{key:"total-asc",value:cbp.delDocsPage.globalVars.totalAsc},{key:"total-desc",value:cbp.delDocsPage.globalVars.totalDesc}],label:cbp.delDocsPage.globalVars.sortBy,labelClass:"xs-mr-5",name:"sortByDdn",display:"displayInline"},c={locationDdnContainer:".js-location-ddn",accountDdnContainer:".js-account-ddn",delDocsSummaryContainer:".js-delDocs-summary",delDocsTypeContainer:".js-delDocsType-ddn",paymentStatusContainer:".js-paymentStatus-ddn",downloadStatusContainer:".js-downloadStatus-ddn",printStatusContainer:".js-printStatus-ddn",pickDateRangeContainer:".js-search-pickDateRange",searchFormContainer:".js-search-form",searchDetailContainer:".js-bottom-detail",sortByDdnContainer:".js-sortbyDdn",dropDownCommon:".selectpicker",ordercalendar:"#calendar",searchButton:"#delDocsSearch",tabelRow:"#table tbody tr",downloadBtn:".js-downloadBtn",printBtn:".js-printBtn",payInvBtn:".js-payInvBtn",delDocTypeDdn:"#delDocTypeDdn",paymentStatusDdn:"#paymentStatusDdn",locationDdn:"#locationSelectDdn",accountDdn:"#accountSelectDdn",downloadStatusDdn:"#downloadStatus",printStatusDdn:"#printStatus",sortByDdn:"#sortByDdn",displaySpinner:".overlay-wrapper",dropdownSelect:".dropdown-menu .toggle-select",delDocNumber:"#delDocNumber",orderNumber:"#orderNumber",poNumber:"#poNumber",squareUnchecked:"fa-square-o",squareChecked:"fa-check-square-o",downloadIcon:".iconsPrintDownload",printIcon:".iconsdelDocPrint"},d=function(){if(h(),1==cbp.delDocsPage.locationDropDown.options.length?x(b(c.locationDdn).val(),"all"):cbp.delDocsPage.locationDropDown.options.length>1&&(b(c.accountDdn).attr("disabled","disabled").selectpicker("refresh"),b(c.searchButton).attr("disabled","disabled")),b(c.locationDdn).selectpicker("refresh"),"true"===alldelDocFlow&&(b(c.downloadStatusDdn).val("notDownloaded").selectpicker("refresh"),b(c.printStatusDdn).val("notPrinted").selectpicker("refresh")),void 0!==localStorage.getItem("delDocObj")&&null!==localStorage.getItem("delDocObj")&&isPaymentFlow){var a=JSON.parse(localStorage.getItem("delDocObj"));startDate=a.startDate,endDate=a.endDate,cbp.delDocsPage.dateRange.startDate=e(startDate,cbp.delDocsPage.dateRange.format,!0),cbp.delDocsPage.dateRange.endDate=e(endDate,cbp.delDocsPage.dateRange.format,!0),b(c.delDocNumber).val(a.delDocNumber),b(c.orderNumber).val(a.salesOrderNumber),b(c.poNumber).val(a.poNumber),b(c.delDocTypeDdn).val(a.delDocTypes).selectpicker("refresh"),b(c.paymentStatusDdn).val(a.paymentStatus).selectpicker("refresh"),b(c.downloadStatusDdn).val(a.downloadStatus).selectpicker("refresh"),b(c.printStatusDdn).val(a.printStatus).selectpicker("refresh"),b(c.locationDdn).val(a.soldTo).selectpicker("refresh"),b.when(x(a.soldTo,a.account)).then(function(a){l()}),localStorage.removeItem("delDocObj"),b(c.searchButton).removeAttr("disabled")}else z(cbp.delDocsPage.delDocsResponse.delDocsDataList);k(),y(),"true"===noCardsAdded&&"true"===ccPaymentEligible?b(".js-card-error").removeClass("hide"):"true"===allCardsExpired&&"true"===ccPaymentEligible&&b(".js-card-expired-error").removeClass("hide")},f=function(){b("#delDocForm #selecteddelDocs").val(selecteddelDocs.toString());for(var a=0;len=selecteddelDocs.length,a<len;a++)b(".iconsPrintDownload[data-delDocid='"+selecteddelDocs[a]+"']").addClass("success-icon"),cbp.delDocsPage.delDocsResponse.delDocsDataList[b("tr[data-uniqueid='"+selecteddelDocs[a]+"']").data("index")].downloaded=!0;b("#delDocForm").submit()},g=function(){b("#delDocForm #selecteddelDocs").val(selecteddelDocs.toString());var a=b("#contextPath").val()+"/delDocs/delDocListPDF",c=b("#delDocForm").attr("action");b("#delDocForm").attr("action",a),b("#delDocForm").attr("target","_blank");for(var d=0;len=selecteddelDocs.length,d<len;d++)b(".iconsdelDocPrint[data-delDocid='"+selecteddelDocs[d]+"']").addClass("success-icon"),cbp.delDocsPage.delDocsResponse.delDocsDataList[b("tr[data-uniqueid='"+selecteddelDocs[d]+"']").data("index")].printed=!0;b("#delDocForm").submit(),b("#delDocForm").attr("action",c),b("#delDocForm").removeAttr("target")},h=function(){b(c.searchFormContainer).html(p(cbp.delDocsPage)),b(c.locationDdnContainer).html(n(cbp.delDocsPage.locationDropDown)),b(c.accountDdnContainer).html(n(cbp.delDocsPage.accountDropDown)),b(c.downloadStatusContainer).html(n(cbp.delDocsPage.downloadStatusDropdown)),b(c.delDocsTypeContainer).html(n(cbp.delDocsPage.delDocTypeDropdown)),b(c.paymentStatusContainer).html(n(cbp.delDocsPage.paymentStatusDropdown)),b(c.printStatusContainer).html(n(cbp.delDocsPage.printStatusDropdown)),b(c.pickDateRangeContainer).html(o({label:cbp.delDocsPage.globalVars.pickDateRange,iconClass:cbp.delDocsPage.dateRange.iconClass,id:cbp.delDocsPage.dateRange.id})),i(),b(c.dropDownCommon).selectpicker("refresh"),j(),b(c.displaySpinner).hide()},i=function(){b(c.delDocsSummaryContainer).html(q(cbp.delDocsPage)),b(c.searchDetailContainer).html(r(cbp.delDocsPage)),b(c.sortByDdnContainer).html(n(a)),b(c.sortByDdnContainer).find(c.dropDownCommon).selectpicker("refresh"),j()},j=function(){/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent)&&b(c.dropDownCommon).selectpicker("mobile")},k=function(){function a(a,d){startDate=a.format(cbp.delDocsPage.dateRange.format),endDate=d.format(cbp.delDocsPage.dateRange.format),b(c.ordercalendar).find("span").html(cbp.delDocsPage.globalVars.fromAndTo.replace("{0}",startDate).replace("{1}",endDate))}"true"===alldelDocFlow&&(cbp.delDocsPage.dateRange.startDate=e().subtract(cbp.delDocsPage.dateRange.maxMonth,"month")),a(cbp.delDocsPage.dateRange.startDate,cbp.delDocsPage.dateRange.endDate);var d={};d[cbp.delDocsPage.dateRange.today]=[e(),e()],d[cbp.delDocsPage.dateRange.yesterday]=[e().subtract(1,"days"),e().subtract(1,"days")],d[cbp.delDocsPage.dateRange.last7Days]=[e().subtract(6,"days"),e()],d[cbp.delDocsPage.dateRange.last30Days]=[e().subtract(29,"days"),e()],d[cbp.delDocsPage.dateRange.thisMonth]=[e().startOf("month"),e().endOf("month")],d[cbp.delDocsPage.dateRange.lastMonth]=[e().subtract(1,"month").startOf("month"),e().subtract(1,"month").endOf("month")],b(c.ordercalendar).daterangepicker({startDate:cbp.delDocsPage.dateRange.startDate,endDate:cbp.delDocsPage.dateRange.endDate,ranges:d,minDate:e().subtract(cbp.delDocsPage.dateRange.maxMonth,"month"),maxDate:e(),applyClass:"btn-primary",locale:{format:cbp.delDocsPage.dateRange.format,separator:" - ",applyLabel:cbp.delDocsPage.dateRange.apply,cancelLabel:cbp.delDocsPage.dateRange.cancel,weekLabel:"W",customRangeLabel:cbp.delDocsPage.dateRange.customRange,daysOfWeek:e.weekdaysShort(),monthNames:e.monthsShort(),firstDay:e.localeData().firstDayOfWeek()}},a)},l=function(){function a(a){b(c.displaySpinner).hide(),b(c.searchDetailContainer).show(),b(c.delDocsSummaryContainer).show(),cbp.delDocsPage.delDocsResponse=a,cbp.delDocsPage.delDocsResponse.resultCount>0?cbp.delDocsPage.globalVars.delDocsFoundVar=cbp.delDocsPage.globalVars.delDocsFound.replace("{0}",cbp.delDocsPage.delDocsResponse.resultCount):cbp.delDocsPage.globalVars.delDocsFoundVar=cbp.delDocsPage.globalVars.delDocsFound.replace("{0}",0),cbp.delDocsPage.dateRange.startDate=e(startDate,cbp.delDocsPage.dateRange.format,!0),cbp.delDocsPage.dateRange.endDate=e(endDate,cbp.delDocsPage.dateRange.format,!0),cbp.delDocsPage.globalVars.summaryfromAndToVar=cbp.delDocsPage.globalVars.summaryfromAndTo.replace("{0}",cbp.delDocsPage.dateRange.startDate.format(cbp.delDocsPage.dateRange.format)).replace("{1}",cbp.delDocsPage.dateRange.endDate.format(cbp.delDocsPage.dateRange.format)),"true"===alldelDocFlow||cbp.delDocsPage.delDocsResponse.resultCount>0&&cbp.delDocsPage.delDocsResponse.resultCount<maxResults?cbp.delDocsPage.showDebitCredit=!0:cbp.delDocsPage.showDebitCredit=!1,i(),z(cbp.delDocsPage.delDocsResponse.delDocsDataList),leftPaneExpandCollapse.resetSearchFormHeight()}function d(){b(c.displaySpinner).hide(),b(c.searchDetailContainer).show(),b(c.delDocsSummaryContainer).show(),console.log("error")}b(c.displaySpinner).show(),b(c.delDocsSummaryContainer).hide(),b(c.searchDetailContainer).hide(),leftPaneExpandCollapse.hideSearchBar();var f=[];b(c.delDocTypeDdn).find("option").each(function(){f.push(b(this).val())});var g={};if(g.account=b(c.accountDdn).val(),g.soldTo=null===b(c.locationDdn).val()?"null":b(c.locationDdn).val().toString(),b(c.delDocNumber).length>0&&(g.delDocNumber=b(c.delDocNumber).val().trim(),b(c.delDocNumber).val(g.delDocNumber)),b(c.orderNumber).length>0&&(g.salesOrderNumber=b(c.orderNumber).val().trim(),b(c.orderNumber).val(g.salesOrderNumber)),b(c.poNumber).length>0&&(g.poNumber=b(c.poNumber).val().trim(),b(c.poNumber).val(g.poNumber)),g.delDocTypes=b(c.delDocTypeDdn).val()?""+b(c.delDocTypeDdn).val():f.toString(),g.downloadStatus=b(c.downloadStatusDdn).val(),g.paymentStatus=b(c.paymentStatusDdn).val(),g.printStatus=b(c.printStatusDdn).val(),""!=b(c.delDocNumber).val()||""!=b(c.orderNumber).val()||""!=b(c.poNumber).val()){var h=e().subtract(cbp.delDocsPage.dateRange.backDatedRange,"month");h=h.format(cbp.delDocsPage.dateRange.format);var j=e();j=j.format(cbp.delDocsPage.dateRange.format),g.fromDate=h,g.toDate=j}else g.fromDate=startDate,g.toDate=endDate;"all"!=b(c.accountDdn).val()?cbp.delDocsPage.showSoldTo=!1:cbp.delDocsPage.showSoldTo=!0,b.ajax({type:cbp.delDocsPage.globalUrl.method,data:g,url:cbp.delDocsPage.globalUrl.delDocPostURL,success:a,error:d})},m=function(a){"1000"==a?(b(c.orderNumber).siblings("label").text(cbp.delDocsPage.globalVars.altRefNumber),b(c.poNumber).siblings("label").text(cbp.delDocsPage.globalVars.originalDocNumber),cbp.delDocsPage.globalVars.orderNumbertb=cbp.delDocsPage.globalVars.altRefNumbertb,cbp.delDocsPage.globalVars.customerPOtb=cbp.delDocsPage.globalVars.originalDocNumbertb):(b(c.orderNumber).siblings("label").text(cbp.delDocsPage.globalVars.orderNumberNew),b(c.poNumber).siblings("label").text(cbp.delDocsPage.globalVars.poNumberNew),cbp.delDocsPage.globalVars.orderNumbertb=cbp.delDocsPage.globalVars.orderNumbertbNew,cbp.delDocsPage.globalVars.customerPOtb=cbp.delDocsPage.globalVars.customerPOtbNew)},s=function(a){for(var b=0,c=locationDropDown.length;c>b&&locationDropDown[b].soldToNumber!=a;b++);return locationDropDown[b].salesOrg},t=function(a){var c=window.location.pathname,d="<form id='downloadForm' method='POST' action='"+c+"/delDocCSV'><input type='hidden' name='selecteddelDocs' value='"+a+"'/></form>";cbp.delDocsPage.delDocsResponse.delDocsDataList[b("tr[data-uniqueid='"+a+"']").data("index")].downloaded=!0,b(d).appendTo("body").submit().remove()},u=function(){b(c.downloadBtn).removeClass("disabled"),b(c.printBtn).removeClass("disabled"),w()},v=function(){b(c.downloadBtn).addClass("disabled"),b(c.printBtn).addClass("disabled"),w()},w=function(){var a=selectedProduct.length;a>=0&&(disablePayError=!0);for(var d=0;a>d;d++)-1==productCodes.indexOf(selectedProduct[d])&&(disablePayError=!1);a>0?b(c.payInvBtn).removeClass("disabled"):b(c.payInvBtn).addClass("disabled"),(disablePayError||0===a)&&b(".js-selected-product-error").addClass("hide")},x=function(a,d){function e(a){b(c.displaySpinner).hide();var e=[],f={},g=a.marketerLocation;1==g.length?cbp.delDocsPage.accountDropDown.singleOption=!0:g.length>1&&(f.key="all",f.value=cbp.delDocsPage.globalVars.allLocation,e.push(f));for(var h=0;h<g.length;h++)f={},f.key=g[h].accountNumber,f.value=g[h].accountAddress,e.push(f);cbp.delDocsPage.accountDropDown.options=e,cbp.delDocsPage.accountDropDown.searchable=!0,b(c.accountDdnContainer).html(n(cbp.delDocsPage.accountDropDown)),b(c.accountDdn).selectpicker("refresh"),cbp.delDocsPage.accountDropDown.options.length>1&&b(c.accountDdn).val(d).selectpicker("refresh");for(var i=[],h=0;h<a.delDocTypeList.length;h++){var j={};j.key=a.delDocTypeList[h].code,j.value=a.delDocTypeList[h].description,i.push(j)}cbp.delDocsPage.delDocTypeDropdown.options=i,b(c.delDocsTypeContainer).html(n(cbp.delDocsPage.delDocTypeDropdown)),b(c.delDocTypeDdn).selectpicker("refresh")}function f(){b(c.displaySpinner).hide(),console.log("error")}return b(c.displaySpinner).show(),b.ajax({type:cbp.delDocsPage.globalUrl.method,data:{soldToNumber:a},url:cbp.delDocsPage.globalUrl.accountURL,success:e,error:f})},y=function(){b(document).on("reset-view.bs.table, toggle.bs.table","#table",function(a){a.stopPropagation();for(var c=0;c<selecteddelDocs.length;c++)b("#table tbody tr[data-uniqueid="+selecteddelDocs[c]+"]").find("input[type=checkbox]").attr("checked","checked")}),b(document).on("click",c.downloadBtn,function(){f()}),b(document).on("click",c.printBtn,function(){g()}),b(c.locationDdn).on("change",function(a){""!==b(c.locationDdn).val()?b(c.searchButton).removeAttr("disabled"):b(c.searchButton).attr("disabled","disabled");var d=s(b(this).val());m(d),x(b(c.locationDdn).val(),"all")}),b(document).on("change",c.accountDdn,function(a){}),b(document).on("click",c.downloadIcon,function(a){var c=b("#isInternalUser").val();"true"!=c&&"true"!==inASMSession&&b(a.target).addClass("success-icon"),t(b(a.target).attr("data-delDocId"))}),b(document).on("click",c.printIcon,function(a){var c=b("#isInternalUser").val();"true"!=c&&"true"!==inASMSession&&b(this).addClass("success-icon"),calldelDocPDF(b(a.target).attr("data-delDocId"))}),b(c.searchButton).on("click",function(a){selecteddelDocs=[],selectedProduct=[],selecteddelDocStatus=[],delDocObj.account=b("#accountSelectDdn").val(),delDocObj.soldTo=b("#locationSelectDdn").val(),delDocObj.delDocNumber=b("#delDocNumber").val(),delDocObj.salesOrderNumber=b("#orderNumber").val(),delDocObj.poNumber=b("#poNumber").val(),delDocObj.delDocTypes=b("#delDocTypeDdn").val(),delDocObj.downloadStatus=b("#downloadStatus").val(),delDocObj.printStatus=b("#printStatus").val(),delDocObj.paymentStatus=b("#paymentStatusDdn").val(),delDocObj.startDate=startDate,delDocObj.endDate=endDate,b(".alert-danger").addClass("hide"),l()});var a=".js-search-form input,"+c.printStatusContainer+","+c.locationDdnContainer+","+c.downloadStatusContainer+","+c.pickDateRangeContainer;b(document).on("keypress",a,function(a){13==a.which&&(a.preventDefault(),b("#delDocsSearch").trigger("click"))});var d=c.delDocNumber+","+c.orderNumber;b(document).on("keypress",d,function(a){var b=/^[0-9]+$/,c=String.fromCharCode(a.which);return!!c.match(b)||(a.preventDefault(),!1)})},z=function(a){var d=0;cbp.delDocsPage.delDocsResponse.resultCount>maxResults&&null===cbp.delDocsPage.delDocsResponse.delDocsDataList?(cbp.delDocsPage.globalVars.tableLocales.noMatches=cbp.delDocsPage.globalVars.noMatchesMaxResults.replace("{0}",cbp.delDocsPage.delDocsResponse.resultCount),a=[]):0===cbp.delDocsPage.delDocsResponse.resultCount?cbp.delDocsPage.globalVars.tableLocales.noMatches=cbp.delDocsPage.globalVars.noMatches:cbp.delDocsPage.delDocsResponse.resultCount>maxResults&&"true"!=alldelDocFlow&&(cbp.delDocsPage.globalVars.tableLocales.noMatches=cbp.delDocsPage.globalVars.noMatchesMaxResults.replace("{0}",cbp.delDocsPage.delDocsResponse.resultCount),a=[]),(null===a||void 0===a)&&(a=[]),b(c.sortByDdn).val("delDocDate-desc").selectpicker("refresh"),b("#table").bootstrapTable({classes:"table table-no-bordered",striped:!0,sortName:"delDocDate",uniqueId:"delDocId",sortOrder:"desc",iconsPrefix:"fa",sortable:!0,parentContainer:".js-bottom-detail",sortByDropdownId:"#sortByDdn",responsive:!0,responsiveBreakPoint:768,responsiveClass:"bootstrap-table-cardview",onCheck:function(a,b){selecteddelDocs.push(a.delDocId),selectedProduct.push(a.type),selecteddelDocStatus.push(a.cbpdelDocStatus),delDocTotalSum+=a.total,delDocStatusCodes.indexOf(a.cbpdelDocStatus)>-1&&(d+=1),d>0&&(enabledelDocError=!0),enableTotalError=0>=delDocTotalSum,u()},onCheckAll:function(a){selecteddelDocs=[],selectedProduct=[],selecteddelDocStatus=[];for(var b=a.length,c=0;b>c;c++)selecteddelDocs.push(a[c].delDocId),selectedProduct.push(a[c].type),selecteddelDocStatus.push(a[c].cbpdelDocStatus),delDocTotalSum+=a[c].total,delDocStatusCodes.indexOf(a[c].cbpdelDocStatus)>-1&&(d+=1),d>0&&(enabledelDocError=!0);0>=delDocTotalSum&&(enableTotalError=!0),a.length&&u()},onUncheck:function(a,e){var f=selecteddelDocs.indexOf(a.delDocId);delDocTotalSum-=a.total,f>-1&&(selecteddelDocs.splice(f,1),selectedProduct.splice(f,1),selecteddelDocStatus.splice(f,1),w()),b(c.tabelRow).hasClass("selected")||v(),delDocStatusCodes.indexOf(a.cbpdelDocStatus)>-1&&(d-=1),0>=d&&(enabledelDocError=!1,b(".js-selected-delDoc-error").addClass("hide")),delDocTotalSum>=0?(enableTotalError=!1,b(".js-total-amount-error").addClass("hide")):enableTotalError=!0,e.parents("tr").removeClass("bg-danger")},onUncheckAll:function(a){selecteddelDocs=[],selectedProduct=[],selecteddelDocStatus=[],d=0,delDocTotalSum=0,enabledelDocError=!1,enableTotalError=!1,b(".js-selected-delDoc-error").addClass("hide"),b(".js-total-amount-error").addClass("hide"),v(),b("#table tbody").find("tr").removeClass("bg-danger")},columns:[{field:"",checkbox:!0,"class":"fa",formatter:function(a,b,c){return'<input type="hidden" name="type" value="'+b.type+"@"+b.cbpdelDocStatus+'">'}},{field:"status",title:cbp.delDocsPage.globalVars.statustb,titleTooltip:cbp.delDocsPage.globalVars.statustb,"class":"text-nowrap",formatter:function(a,b,c){var d,e,f="",g="";return b.downloaded&&"true"!==inASMSession&&(f="success-icon"),b.printed&&"true"!==inASMSession&&(g="success-icon"),d="<span class='fa fa-download iconsPrintDownload xs-pr-10 "+f+"' data-delDocId='"+b.delDocId+"'></span>",e="<span class='fa fa-print iconsdelDocPrint "+g+"' data-delDocId='"+b.delDocId+"'></span>",d+e}},{field:"location",title:cbp.delDocsPage.globalVars.locationtb,titleTooltip:cbp.delDocsPage.globalVars.locationtb,sortable:!0},{field:"delDocDate",title:cbp.delDocsPage.globalVars.pickDatetb,titleTooltip:cbp.delDocsPage.globalVars.pickDatetb,"class":"numberIcon text-nowrap",sorter:function(a,b){return a=e(a,cbp.delDocsPage.dateRange.format,!0).format(),b=e(b,cbp.delDocsPage.dateRange.format,!0).format(),b>a?-1:a>b?1:0},sortable:!0,align:"right"},{field:"orderId",title:cbp.delDocsPage.globalVars.orderNumbertb+"<br> <i>"+cbp.delDocsPage.globalVars.customerPOtb+"</i>",titleTooltip:cbp.delDocsPage.globalVars.orderNumbertb,"class":"numberIcon text-nowrap",sortable:!0,formatter:function(a,b,c){var d,e;return d="ZOOR"==b.salesOrderType&&orderAvailable&&!cbp.delDocsPage.isNARegion?'<a href="javascript:void(0);" onclick="goToOrderDetails(\''+b.orderId+"')\">"+b.orderId+"</a>":b.orderId,e=void 0===b.purchaseOrderNumber||null===b.purchaseOrderNumber?"":"<br> <i>"+b.purchaseOrderNumber+"</i>",d+e}},{field:"delDocId",title:cbp.delDocsPage.globalVars.delDoctb+(showLegal?"<br> <i>"+cbp.delDocsPage.globalVars.legaldelDoctb+"</i>":""),titleTooltip:cbp.delDocsPage.globalVars.delDoctb,"class":"numberIcon text-nowrap",sortable:!0,formatter:function(a,b,c){var d,e;return d='<a href="javascript:void(0);" onclick="calldelDocPDFLink(\''+b.delDocId+"')\">"+b.delDocId+"</a>",e=void 0===b.legalDocumentNumber||null===b.legalDocumentNumber?"":showLegal?"<br> <i>"+b.legalDocumentNumber+"</i>":"",d+e}},{field:"type",title:cbp.delDocsPage.globalVars.docTypetb,titleTooltip:cbp.delDocsPage.globalVars.docTypetb,"class":cbp.delDocsPage.isNARegion?"":"text-nowrap",sortable:!0,formatter:function(a,b,c){return delDocTypeMapper[a]}},{field:"total",title:cbp.delDocsPage.globalVars.totaltb+(""===cbp.delDocsPage.delDocsResponse.currency?"":" ("+cbp.delDocsPage.delDocsResponse.currency+")")+("true"==ccPaymentEligible?"<br> <i>"+cbp.delDocsPage.globalVars.paymentStatustb+"</i>":""),titleTooltip:cbp.delDocsPage.globalVars.totaltb+" ("+cbp.delDocsPage.delDocsResponse.currency+")","class":"numberIcon text-nowrap",sortable:!0,align:"right",sorter:function(a,b){return null!==a&&null!==b&&(a=parseFloat(a),b=parseFloat(b)),b>a?-1:a>b?1:0},formatter:function(a,b,c){var d,e;return d=a>="0"?b.displayTotal:"<span class='text-danger'>"+b.displayTotal+"</span>",e=void 0===b.cbpdelDocStatus||null===b.cbpdelDocStatus||"false"==ccPaymentEligible||"00"===b.cbpdelDocStatus?"":"<br> <i><span class='text-danger'>"+delDocStatusMapper[b.cbpdelDocStatus]+"</span></i>",d+e}},{field:"eftNumber",title:cbp.delDocsPage.globalVars.eftNumber,titleTooltip:cbp.delDocsPage.globalVars.eftNumber,"class":"text-nowrap",sortable:!0,visible:cbp.delDocsPage.showEFT,formatter:function(a,b,c){return'<a href="javascript:void(0);" onclick="goToEftDetails(\''+a+"', '"+b.fiscalYear+"')\">"+a+"</a>"}},{field:"deliveryDate",title:cbp.delDocsPage.globalVars.deliveryDate,titleTooltip:cbp.delDocsPage.globalVars.deliveryDate,"class":"text-nowrap",visible:cbp.delDocsPage.showDeliveryDate,sortable:!0}],data:a})};return{init:d}}();b(document).ready(function(){b.fn.selectpicker.defaults={noneSelectedText:cbp.delDocsPage.globalVars.selectDdn.noneSelectedText,noneResultsText:cbp.delDocsPage.globalVars.selectDdn.noneResultsText,countSelectedText:function(a,b){return 1==a?cbp.delDocsPage.globalVars.selectDdn.itemSelected:cbp.delDocsPage.globalVars.selectDdn.itemSelected1},maxOptionsText:function(a,b){return[1==a?cbp.delDocsPage.globalVars.selectDdn.limitReached:cbp.delDocsPage.globalVars.selectDdn.limitReached1,1==b?cbp.delDocsPage.globalVars.selectDdn.groupLimit:cbp.delDocsPage.globalVars.selectDdn.groupLimit1]},selectAllText:cbp.delDocsPage.globalVars.selectDdn.selectAllText,deselectAllText:cbp.delDocsPage.globalVars.selectDdn.deselectAllText},b.fn.bootstrapTable.locales={formatLoadingMessage:function(){return cbp.delDocsPage.globalVars.tableLocales.loadingMessage},formatRecordsPerPage:function(a){return cbp.delDocsPage.globalVars.tableLocales.recordsPerPage.replace("{0}",a)},formatShowingRows:function(a,b,c){return cbp.delDocsPage.globalVars.tableLocales.showingRows.replace("{0}",a).replace("{1}",b).replace("{2}",c)},formatSearch:function(){return cbp.delDocsPage.globalVars.tableLocales.search},formatNoMatches:function(){return cbp.delDocsPage.globalVars.tableLocales.noMatches},formatPaginationSwitch:function(){return cbp.delDocsPage.globalVars.tableLocales.paginationSwitch},formatRefresh:function(){return cbp.delDocsPage.globalVars.tableLocales.refresh},formatToggle:function(){return cbp.delDocsPage.globalVars.tableLocales.toggle},formatColumns:function(){return cbp.delDocsPage.globalVars.tableLocales.columns},formatAllRows:function(){return cbp.delDocsPage.globalVars.tableLocales.allRows}},b.extend(b.fn.bootstrapTable.defaults,b.fn.bootstrapTable.locales),"false"==noCardsAdded&&"false"==allCardsExpired&&"true"==ccPaymentEligible&&"true"==showPaydelDoc?cbp.delDocsPage.showHidedelDocBtn="false":cbp.delDocsPage.showHidedelDocBtn="true",leftPaneExpandCollapse.init(),cbp.delDocsPage.showSoldTo=!0,cbp.delDocsPage.delDocsResponse=delDocsResponse,void 0===delDocsResponse.resultCount||null===delDocsResponse.resultCount?(cbp.delDocsPage.delDocsResponse.resultCount=0,cbp.delDocsPage.globalVars.delDocsFoundVar=cbp.delDocsPage.globalVars.delDocsFound.replace("{0}",0)):cbp.delDocsPage.globalVars.delDocsFoundVar=cbp.delDocsPage.globalVars.delDocsFound.replace("{0}",delDocsResponse.resultCount),(void 0===delDocsResponse.delDocsDataList||null===delDocsResponse.delDocsDataList)&&(cbp.delDocsPage.delDocsResponse.delDocsDataList=[]),"true"===alldelDocFlow||cbp.delDocsPage.delDocsResponse.resultCount>0&&cbp.delDocsPage.delDocsResponse.resultCount<maxResults?cbp.delDocsPage.showDebitCredit=!0:cbp.delDocsPage.showDebitCredit=!1,cbp.delDocsPage.dateRange.startDate=e().subtract(pastSelectableDate,"days"),cbp.delDocsPage.dateRange.endDate=e(),"true"===alldelDocFlow&&(cbp.delDocsPage.dateRange.startDate=e().subtract(cbp.delDocsPage.dateRange.maxMonth,"month")),cbp.delDocsPage.globalVars.summaryfromAndToVar=cbp.delDocsPage.globalVars.summaryfromAndTo.replace("{0}",cbp.delDocsPage.dateRange.startDate.format(cbp.delDocsPage.dateRange.format)).replace("{1}",cbp.delDocsPage.dateRange.endDate.format(cbp.delDocsPage.dateRange.format)),cbp.delDocsPage.ccPaymentEligible=ccPaymentEligible,cbp.delDocsPage.isNARegion=isNARegion,cbp.delDocsPage.isNARegion?(cbp.delDocsPage.showDeliveryDate=!0,cbp.delDocsPage.showEFT=!0):(cbp.delDocsPage.showDeliveryDate=!1,cbp.delDocsPage.showEFT=!1),s.init()})});